ORG 8000H

; MEMORY LOCATIONS OF 7-SEG ARRAY
SEG1 EQU 0FFC3H
SEG2 EQU 0FFC2H
SEG3 EQU 0FFC1H

; INITIAL VALUES FOR EACH SEGMENTS
START:
	MOV R0, #00H
	MOV R1, #00H
	MOV R2, #00H

; MAIN LOOP
LOOP:
	CALL DISPLAY_SEGMENT
	CALL DELAY
	CALL INCREMENT_ARRAY
	JMP LOOP

; INCREMENT SECTIONS FOR HANDLING SEGMENTS
; CAREFUL TO CARRY BIT & DA INSTRUCTION
INCREMENT_R0:
	MOV A, R0
	INC A
	DA A
	MOV R0, A
	RET

INCREMENT_R1:
	MOV A, R1
	INC A
	DA A
	MOV R1, A
	RET

INCREMENT_R2:
	MOV A, R2
	INC A
	DA A
	MOV R2, A
	RET

; INCREMENT THE 7 SEGMENT ARRAY
INCREMENT_ARRAY:
	CALL INCREMENT_R2
	CJNE R2, #00H, FINISH
	CALL INCREMENT_R1
	CJNE R1, #00H, FINISH
	CALL INCREMENT_R0
FINISH:
	RET

; DELAY SUBROUTINE
DELAY: MOV R6, #80H
DELAY1: MOV R7, #80H
DELAY2: DJNZ R7, DELAY2
	DJNZ R6, DELAY1
	RET

; DISPLAY LEFT, MIDDLE, AND RIGHT SEGMENTS
DISPLAY_SEGMENT:
	MOV A, R0
	MOV DPTR, #SEG1
	MOVX @DPTR, A

	MOV A, R1
	MOV DPTR, #SEG2
	MOVX @DPTR, A

	MOV A, R2
	MOV DPTR, #SEG3
	MOVX @DPTR, A

	RET

END